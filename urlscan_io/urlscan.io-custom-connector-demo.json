{"swagger":"2.0","info":{"version":"1.0.0","title":"urlscan.io","description":"urlscan.io"},"host":"urlscan.io","basePath":"/","schemes":["https"],"consumes":[],"produces":["application/json"],"paths":{"/api/v1/scan":{"post":{"summary":"Submit URL","description":"Submit URL","operationId":"SubmitUrl","parameters":[{"name":"Content-Type","in":"header","required":true,"type":"string","default":"application/json","description":"Content-Type"},{"name":"body","in":"body","schema":{"type":"object","properties":{"url":{"type":"string","description":"url"},"visibility":{"type":"string","description":"visibility"},"tags":{"type":"array","items":{"type":"string"},"description":"tags"}},"default":{"url":"https://www.microsoft.com","visibility":"public","tags":["sjmtest"]}},"required":true}],"responses":{"default":{"description":"default","schema":{"type":"object","properties":{"message":{"type":"string","description":"message"},"uuid":{"type":"string","description":"uuid"},"result":{"type":"string","description":"result"},"api":{"type":"string","description":"api"},"visibility":{"type":"string","description":"visibility"},"options":{"type":"object","properties":{},"description":"options"},"url":{"type":"string","description":"url"},"country":{"type":"string","description":"country"}}}}}}},"/api/v1/search":{"get":{"summary":"Search","description":"Search","operationId":"Search","parameters":[{"name":"q","default":"domain:microsoft.com","in":"query","type":"string","required":true},{"name":"size","default":"1","in":"query","type":"string","required":true}],"responses":{"default":{"description":"default","schema":{"type":"object","properties":{"results":{"type":"array","items":{"type":"object","properties":{"task":{"type":"object","properties":{"visibility":{"type":"string","description":"visibility"},"method":{"type":"string","description":"method"},"domain":{"type":"string","description":"domain"},"apexDomain":{"type":"string","description":"apexDomain"},"time":{"type":"string","description":"time"},"uuid":{"type":"string","description":"uuid"},"url":{"type":"string","description":"url"}},"description":"task"},"stats":{"type":"object","properties":{"uniqIPs":{"type":"integer","format":"int32","description":"uniqIPs"},"uniqCountries":{"type":"integer","format":"int32","description":"uniqCountries"},"dataLength":{"type":"integer","format":"int32","description":"dataLength"},"encodedDataLength":{"type":"integer","format":"int32","description":"encodedDataLength"},"requests":{"type":"integer","format":"int32","description":"requests"}},"description":"stats"},"page":{"type":"object","properties":{"country":{"type":"string","description":"country"},"redirected":{"type":"string","description":"redirected"},"ip":{"type":"string","description":"ip"},"mimeType":{"type":"string","description":"mimeType"},"title":{"type":"string","description":"title"},"url":{"type":"string","description":"url"},"tlsValidDays":{"type":"integer","format":"int32","description":"tlsValidDays"},"tlsAgeDays":{"type":"integer","format":"int32","description":"tlsAgeDays"},"tlsValidFrom":{"type":"string","description":"tlsValidFrom"},"domain":{"type":"string","description":"domain"},"umbrellaRank":{"type":"integer","format":"int32","description":"umbrellaRank"},"apexDomain":{"type":"string","description":"apexDomain"},"asnname":{"type":"string","description":"asnname"},"asn":{"type":"string","description":"asn"},"tlsIssuer":{"type":"string","description":"tlsIssuer"},"status":{"type":"string","description":"status"}},"description":"page"},"_id":{"type":"string","description":"_id"},"sort":{"type":"array","items":{"type":"string"},"description":"sort"},"result":{"type":"string","description":"result"},"screenshot":{"type":"string","description":"screenshot"}}},"description":"results"},"total":{"type":"integer","format":"int32","description":"total"},"took":{"type":"integer","format":"int32","description":"took"},"has_more":{"type":"boolean","description":"has_more"}}}}}}},"/api/v1/result/{uuid}":{"get":{"summary":"Scan Results","description":"Scan Results","operationId":"ScanResults","parameters":[{"name":"uuid","in":"path","type":"string","required":true}],"responses":{"default":{"description":"default","schema":{"type":"object","properties":{"data":{"type":"object","properties":{"requests":{"type":"array","items":{"type":"object","properties":{"request":{"type":"object","properties":{"requestId":{"type":"string","description":"requestId"},"loaderId":{"type":"string","description":"loaderId"},"documentURL":{"type":"string","description":"documentURL"},"request":{"type":"object","properties":{"url":{"type":"string","description":"url"},"method":{"type":"string","description":"method"},"headers":{"type":"object","properties":{"Upgrade-Insecure-Requests":{"type":"string","description":"Upgrade-Insecure-Requests"},"User-Agent":{"type":"string","description":"User-Agent"},"accept-language":{"type":"string","description":"accept-language"},"Referer":{"type":"string","description":"Referer"}},"description":"headers"},"mixedContentType":{"type":"string","description":"mixedContentType"},"initialPriority":{"type":"string","description":"initialPriority"},"referrerPolicy":{"type":"string","description":"referrerPolicy"},"isSameSite":{"type":"boolean","description":"isSameSite"}},"description":"request"},"timestamp":{"type":"number","format":"float","description":"timestamp"},"wallTime":{"type":"number","format":"float","description":"wallTime"},"initiator":{"type":"object","properties":{"type":{"type":"string","description":"type"},"url":{"type":"string","description":"url"},"lineNumber":{"type":"integer","format":"int32","description":"lineNumber"},"columnNumber":{"type":"integer","format":"int32","description":"columnNumber"}},"description":"initiator"},"redirectHasExtraInfo":{"type":"boolean","description":"redirectHasExtraInfo"},"type":{"type":"string","description":"type"},"frameId":{"type":"string","description":"frameId"},"hasUserGesture":{"type":"boolean","description":"hasUserGesture"},"primaryRequest":{"type":"boolean","description":"primaryRequest"}},"description":"request"},"response":{"type":"object","properties":{"encodedDataLength":{"type":"integer","format":"int32","description":"encodedDataLength"},"dataLength":{"type":"integer","format":"int32","description":"dataLength"},"requestId":{"type":"string","description":"requestId"},"type":{"type":"string","description":"type"},"response":{"type":"object","properties":{"url":{"type":"string","description":"url"},"status":{"type":"integer","format":"int32","description":"status"},"statusText":{"type":"string","description":"statusText"},"headers":{"type":"object","properties":{"alt-svc":{"type":"string","description":"alt-svc"},"cf-cache-status":{"type":"string","description":"cf-cache-status"},"cf-ray":{"type":"string","description":"cf-ray"},"content-encoding":{"type":"string","description":"content-encoding"},"content-md5":{"type":"string","description":"content-md5"},"content-type":{"type":"string","description":"content-type"},"date":{"type":"string","description":"date"},"last-modified":{"type":"string","description":"last-modified"},"nel":{"type":"object","properties":{"success_fraction":{"type":"integer","format":"int32","description":"success_fraction"},"report_to":{"type":"string","description":"report_to"},"max_age":{"type":"integer","format":"int32","description":"max_age"}},"description":"nel"},"report-to":{"type":"object","properties":{"endpoints":{"type":"array","items":{"type":"object","properties":{"url":{"type":"string","description":"url"}}},"description":"endpoints"},"group":{"type":"string","description":"group"},"max_age":{"type":"integer","format":"int32","description":"max_age"}},"description":"report-to"},"server":{"type":"string","description":"server"},"x-ms-request-id":{"type":"string","description":"x-ms-request-id"},"x-ms-version":{"type":"string","description":"x-ms-version"},"age":{"type":"string","description":"age"},"etag":{"type":"string","description":"etag"},"vary":{"type":"string","description":"vary"}},"description":"headers"},"mimeType":{"type":"string","description":"mimeType"},"remoteIPAddress":{"type":"string","description":"remoteIPAddress"},"remotePort":{"type":"integer","format":"int32","description":"remotePort"},"encodedDataLength":{"type":"integer","format":"int32","description":"encodedDataLength"},"timing":{"type":"object","properties":{"requestTime":{"type":"number","format":"float","description":"requestTime"},"proxyStart":{"type":"integer","format":"int32","description":"proxyStart"},"proxyEnd":{"type":"integer","format":"int32","description":"proxyEnd"},"dnsStart":{"type":"integer","format":"int32","description":"dnsStart"},"dnsEnd":{"type":"integer","format":"int32","description":"dnsEnd"},"connectStart":{"type":"integer","format":"int32","description":"connectStart"},"connectEnd":{"type":"integer","format":"int32","description":"connectEnd"},"sslStart":{"type":"integer","format":"int32","description":"sslStart"},"sslEnd":{"type":"integer","format":"int32","description":"sslEnd"},"workerStart":{"type":"integer","format":"int32","description":"workerStart"},"workerReady":{"type":"integer","format":"int32","description":"workerReady"},"workerFetchStart":{"type":"integer","format":"int32","description":"workerFetchStart"},"workerRespondWithSettled":{"type":"integer","format":"int32","description":"workerRespondWithSettled"},"sendStart":{"type":"number","format":"float","description":"sendStart"},"sendEnd":{"type":"number","format":"float","description":"sendEnd"},"pushStart":{"type":"integer","format":"int32","description":"pushStart"},"pushEnd":{"type":"integer","format":"int32","description":"pushEnd"},"receiveHeadersEnd":{"type":"number","format":"float","description":"receiveHeadersEnd"}},"description":"timing"},"responseTime":{"type":"number","format":"float","description":"responseTime"},"protocol":{"type":"string","description":"protocol"},"securityState":{"type":"string","description":"securityState"},"securityDetails":{"type":"object","properties":{"protocol":{"type":"string","description":"protocol"},"keyExchange":{"type":"string","description":"keyExchange"},"keyExchangeGroup":{"type":"string","description":"keyExchangeGroup"},"cipher":{"type":"string","description":"cipher"},"certificateId":{"type":"integer","format":"int32","description":"certificateId"},"subjectName":{"type":"string","description":"subjectName"},"sanList":{"type":"array","items":{"type":"string"},"description":"sanList"},"issuer":{"type":"string","description":"issuer"},"validFrom":{"type":"integer","format":"int32","description":"validFrom"},"validTo":{"type":"integer","format":"int32","description":"validTo"},"signedCertificateTimestampList":{"type":"array","items":{},"description":"signedCertificateTimestampList"},"certificateTransparencyCompliance":{"type":"string","description":"certificateTransparencyCompliance"},"serverSignatureAlgorithm":{"type":"integer","format":"int32","description":"serverSignatureAlgorithm"},"encryptedClientHello":{"type":"boolean","description":"encryptedClientHello"}},"description":"securityDetails"}},"description":"response"},"hasExtraInfo":{"type":"boolean","description":"hasExtraInfo"},"hash":{"type":"string","description":"hash"},"size":{"type":"integer","format":"int32","description":"size"},"asn":{"type":"object","properties":{"ip":{"type":"string","description":"ip"},"asn":{"type":"string","description":"asn"},"country":{"type":"string","description":"country"},"registrar":{"type":"string","description":"registrar"},"date":{"type":"string","description":"date"},"description":{"type":"string","description":"description"},"route":{"type":"string","description":"route"},"name":{"type":"string","description":"name"}},"description":"asn"},"geoip":{"type":"object","properties":{"country":{"type":"string","description":"country"},"region":{"type":"string","description":"region"},"timezone":{"type":"string","description":"timezone"},"city":{"type":"string","description":"city"},"ll":{"type":"array","items":{"type":"number","format":"float"},"description":"ll"},"country_name":{"type":"string","description":"country_name"},"metro":{"type":"integer","format":"int32","description":"metro"}},"description":"geoip"}},"description":"response"},"initiatorInfo":{"type":"object","properties":{"url":{"type":"string","description":"url"},"host":{"type":"string","description":"host"},"type":{"type":"string","description":"type"}},"description":"initiatorInfo"}}},"description":"requests"},"cookies":{"type":"array","items":{},"description":"cookies"},"console":{"type":"array","items":{},"description":"console"},"links":{"type":"array","items":{},"description":"links"},"timing":{"type":"object","properties":{"beginNavigation":{"type":"string","description":"beginNavigation"},"frameStartedLoading":{"type":"string","description":"frameStartedLoading"},"frameNavigated":{"type":"string","description":"frameNavigated"},"domContentEventFired":{"type":"string","description":"domContentEventFired"},"frameStoppedLoading":{"type":"string","description":"frameStoppedLoading"}},"description":"timing"},"globals":{"type":"array","items":{"type":"object","properties":{"prop":{"type":"string","description":"prop"},"type":{"type":"string","description":"type"}}},"description":"globals"}},"description":"data"},"stats":{"type":"object","properties":{"resourceStats":{"type":"array","items":{"type":"object","properties":{"count":{"type":"integer","format":"int32","description":"count"},"size":{"type":"integer","format":"int32","description":"size"},"encodedSize":{"type":"integer","format":"int32","description":"encodedSize"},"latency":{"type":"integer","format":"int32","description":"latency"},"countries":{"type":"array","items":{"type":"string"},"description":"countries"},"ips":{"type":"array","items":{"type":"string"},"description":"ips"},"type":{"type":"string","description":"type"},"compression":{"type":"string","description":"compression"},"percentage":{"type":"integer","format":"int32","description":"percentage"}}},"description":"resourceStats"},"protocolStats":{"type":"array","items":{"type":"object","properties":{"count":{"type":"integer","format":"int32","description":"count"},"size":{"type":"integer","format":"int32","description":"size"},"encodedSize":{"type":"integer","format":"int32","description":"encodedSize"},"ips":{"type":"array","items":{"type":"string"},"description":"ips"},"countries":{"type":"array","items":{"type":"string"},"description":"countries"},"securityState":{"type":"object","properties":{},"description":"securityState"},"protocol":{"type":"string","description":"protocol"}}},"description":"protocolStats"},"tlsStats":{"type":"array","items":{"type":"object","properties":{"count":{"type":"integer","format":"int32","description":"count"},"size":{"type":"integer","format":"int32","description":"size"},"encodedSize":{"type":"integer","format":"int32","description":"encodedSize"},"ips":{"type":"array","items":{"type":"string"},"description":"ips"},"countries":{"type":"array","items":{"type":"string"},"description":"countries"},"protocols":{"type":"object","properties":{"TLS 1.3 /  / AES_128_GCM":{"type":"integer","format":"int32","description":"TLS 1.3 /  / AES_128_GCM"}},"description":"protocols"},"securityState":{"type":"string","description":"securityState"}}},"description":"tlsStats"},"serverStats":{"type":"array","items":{"type":"object","properties":{"count":{"type":"integer","format":"int32","description":"count"},"size":{"type":"integer","format":"int32","description":"size"},"encodedSize":{"type":"integer","format":"int32","description":"encodedSize"},"ips":{"type":"array","items":{"type":"string"},"description":"ips"},"countries":{"type":"array","items":{"type":"string"},"description":"countries"},"server":{"type":"string","description":"server"}}},"description":"serverStats"},"domainStats":{"type":"array","items":{"type":"object","properties":{"count":{"type":"integer","format":"int32","description":"count"},"ips":{"type":"array","items":{"type":"string"},"description":"ips"},"domain":{"type":"string","description":"domain"},"size":{"type":"integer","format":"int32","description":"size"},"encodedSize":{"type":"integer","format":"int32","description":"encodedSize"},"countries":{"type":"array","items":{"type":"string"},"description":"countries"},"index":{"type":"integer","format":"int32","description":"index"},"initiators":{"type":"array","items":{"type":"string"},"description":"initiators"},"redirects":{"type":"integer","format":"int32","description":"redirects"}}},"description":"domainStats"},"regDomainStats":{"type":"array","items":{"type":"object","properties":{"count":{"type":"integer","format":"int32","description":"count"},"ips":{"type":"array","items":{"type":"string"},"description":"ips"},"regDomain":{"type":"string","description":"regDomain"},"size":{"type":"integer","format":"int32","description":"size"},"encodedSize":{"type":"integer","format":"int32","description":"encodedSize"},"countries":{"type":"array","items":{},"description":"countries"},"index":{"type":"integer","format":"int32","description":"index"},"subDomains":{"type":"array","items":{"type":"object","properties":{"domain":{"type":"string","description":"domain"},"country":{"type":"string","description":"country"}}},"description":"subDomains"},"redirects":{"type":"integer","format":"int32","description":"redirects"}}},"description":"regDomainStats"},"secureRequests":{"type":"integer","format":"int32","description":"secureRequests"},"securePercentage":{"type":"integer","format":"int32","description":"securePercentage"},"IPv6Percentage":{"type":"integer","format":"int32","description":"IPv6Percentage"},"uniqCountries":{"type":"integer","format":"int32","description":"uniqCountries"},"totalLinks":{"type":"integer","format":"int32","description":"totalLinks"},"malicious":{"type":"integer","format":"int32","description":"malicious"},"adBlocked":{"type":"integer","format":"int32","description":"adBlocked"},"ipStats":{"type":"array","items":{"type":"object","properties":{"requests":{"type":"integer","format":"int32","description":"requests"},"domains":{"type":"array","items":{"type":"string"},"description":"domains"},"ip":{"type":"string","description":"ip"},"asn":{"type":"object","properties":{"ip":{"type":"string","description":"ip"},"asn":{"type":"string","description":"asn"},"country":{"type":"string","description":"country"},"registrar":{"type":"string","description":"registrar"},"date":{"type":"string","description":"date"},"description":{"type":"string","description":"description"},"route":{"type":"string","description":"route"},"name":{"type":"string","description":"name"}},"description":"asn"},"dns":{"type":"object","properties":{},"description":"dns"},"geoip":{"type":"object","properties":{"country":{"type":"string","description":"country"},"region":{"type":"string","description":"region"},"timezone":{"type":"string","description":"timezone"},"city":{"type":"string","description":"city"},"ll":{"type":"array","items":{"type":"number","format":"float"},"description":"ll"},"country_name":{"type":"string","description":"country_name"},"metro":{"type":"integer","format":"int32","description":"metro"}},"description":"geoip"},"size":{"type":"integer","format":"int32","description":"size"},"encodedSize":{"type":"integer","format":"int32","description":"encodedSize"},"countries":{"type":"array","items":{"type":"string"},"description":"countries"},"index":{"type":"integer","format":"int32","description":"index"},"ipv6":{"type":"boolean","description":"ipv6"},"redirects":{"type":"integer","format":"int32","description":"redirects"},"count":{"type":"string","description":"count"}}},"description":"ipStats"}},"description":"stats"},"meta":{"type":"object","properties":{"processors":{"type":"object","properties":{"umbrella":{"type":"object","properties":{"data":{"type":"array","items":{},"description":"data"}},"description":"umbrella"},"geoip":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"ip":{"type":"string","description":"ip"},"geoip":{"type":"object","properties":{"country":{"type":"string","description":"country"},"region":{"type":"string","description":"region"},"timezone":{"type":"string","description":"timezone"},"city":{"type":"string","description":"city"},"ll":{"type":"array","items":{"type":"number","format":"float"},"description":"ll"},"country_name":{"type":"string","description":"country_name"},"metro":{"type":"integer","format":"int32","description":"metro"}},"description":"geoip"}}},"description":"data"}},"description":"geoip"},"rdns":{"type":"object","properties":{"data":{"type":"array","items":{},"description":"data"}},"description":"rdns"},"asn":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"ip":{"type":"string","description":"ip"},"asn":{"type":"string","description":"asn"},"country":{"type":"string","description":"country"},"registrar":{"type":"string","description":"registrar"},"date":{"type":"string","description":"date"},"description":{"type":"string","description":"description"},"route":{"type":"string","description":"route"},"name":{"type":"string","description":"name"}}},"description":"data"}},"description":"asn"},"wappa":{"type":"object","properties":{"data":{"type":"array","items":{},"description":"data"}},"description":"wappa"}},"description":"processors"}},"description":"meta"},"task":{"type":"object","properties":{"uuid":{"type":"string","description":"uuid"},"time":{"type":"string","description":"time"},"url":{"type":"string","description":"url"},"visibility":{"type":"string","description":"visibility"},"method":{"type":"string","description":"method"},"source":{"type":"string","description":"source"},"tags":{"type":"array","items":{"type":"string"},"description":"tags"},"reportURL":{"type":"string","description":"reportURL"},"screenshotURL":{"type":"string","description":"screenshotURL"},"domURL":{"type":"string","description":"domURL"}},"description":"task"},"page":{"type":"object","properties":{"url":{"type":"string","description":"url"},"domain":{"type":"string","description":"domain"},"country":{"type":"string","description":"country"},"city":{"type":"string","description":"city"},"server":{"type":"string","description":"server"},"ip":{"type":"string","description":"ip"},"asn":{"type":"string","description":"asn"},"asnname":{"type":"string","description":"asnname"}},"description":"page"},"lists":{"type":"object","properties":{"ips":{"type":"array","items":{"type":"string"},"description":"ips"},"countries":{"type":"array","items":{"type":"string"},"description":"countries"},"asns":{"type":"array","items":{"type":"string"},"description":"asns"},"domains":{"type":"array","items":{"type":"string"},"description":"domains"},"servers":{"type":"array","items":{"type":"string"},"description":"servers"},"urls":{"type":"array","items":{"type":"string"},"description":"urls"},"linkDomains":{"type":"array","items":{},"description":"linkDomains"},"certificates":{"type":"array","items":{"type":"object","properties":{"subjectName":{"type":"string","description":"subjectName"},"issuer":{"type":"string","description":"issuer"},"validFrom":{"type":"integer","format":"int32","description":"validFrom"},"validTo":{"type":"integer","format":"int32","description":"validTo"}}},"description":"certificates"},"hashes":{"type":"array","items":{"type":"string"},"description":"hashes"}},"description":"lists"},"verdicts":{"type":"object","properties":{"overall":{"type":"object","properties":{"score":{"type":"integer","format":"int32","description":"score"},"categories":{"type":"array","items":{},"description":"categories"},"brands":{"type":"array","items":{},"description":"brands"},"tags":{"type":"array","items":{},"description":"tags"},"malicious":{"type":"boolean","description":"malicious"},"hasVerdicts":{"type":"boolean","description":"hasVerdicts"}},"description":"overall"},"urlscan":{"type":"object","properties":{"score":{"type":"integer","format":"int32","description":"score"},"categories":{"type":"array","items":{},"description":"categories"},"brands":{"type":"array","items":{},"description":"brands"},"tags":{"type":"array","items":{},"description":"tags"},"malicious":{"type":"boolean","description":"malicious"},"hasVerdicts":{"type":"boolean","description":"hasVerdicts"}},"description":"urlscan"},"engines":{"type":"object","properties":{"score":{"type":"integer","format":"int32","description":"score"},"categories":{"type":"array","items":{},"description":"categories"},"enginesTotal":{"type":"integer","format":"int32","description":"enginesTotal"},"maliciousTotal":{"type":"integer","format":"int32","description":"maliciousTotal"},"benignTotal":{"type":"integer","format":"int32","description":"benignTotal"},"maliciousVerdicts":{"type":"array","items":{},"description":"maliciousVerdicts"},"benignVerdicts":{"type":"array","items":{},"description":"benignVerdicts"},"malicious":{"type":"boolean","description":"malicious"},"hasVerdicts":{"type":"boolean","description":"hasVerdicts"}},"description":"engines"},"community":{"type":"object","properties":{"score":{"type":"integer","format":"int32","description":"score"},"categories":{"type":"array","items":{},"description":"categories"},"brands":{"type":"array","items":{},"description":"brands"},"votesTotal":{"type":"integer","format":"int32","description":"votesTotal"},"votesMalicious":{"type":"integer","format":"int32","description":"votesMalicious"},"votesBenign":{"type":"integer","format":"int32","description":"votesBenign"},"malicious":{"type":"boolean","description":"malicious"},"hasVerdicts":{"type":"boolean","description":"hasVerdicts"}},"description":"community"}},"description":"verdicts"},"submitter":{"type":"object","properties":{"country":{"type":"string","description":"country"}},"description":"submitter"}}}}}}}},"definitions":{},"parameters":{},"responses":{},"securityDefinitions":{"API Key":{"type":"apiKey","in":"header","name":"API-Key"}},"security":[{"API Key":[]}],"tags":[]}